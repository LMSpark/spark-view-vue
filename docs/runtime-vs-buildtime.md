# è¿è¡Œæ—¶æ¶æ„ vs ç¼–è¯‘æ—¶æ¶æ„

## æ ¸å¿ƒå·®å¼‚

### âŒ å½“å‰é—®é¢˜ï¼šè¿è¡Œæ—¶è€¦åˆ

**å‰ç«¯ä»ç„¶ä¾èµ– DSL**ï¼š
```
ç”¨æˆ·è®¿é—® â†’ Nginx â†’ API Server â†’ è¯»å– DSL â†’ ç¼–è¯‘ â†’ è¿”å›
                                  â†‘
                              ä»éœ€ DSL æ–‡ä»¶
```

**é—®é¢˜**ï¼š
1. å‰ç«¯è¿è¡Œä¾èµ–åç«¯æœåŠ¡
2. éœ€è¦ API Server å®æ—¶ç¼–è¯‘
3. DSL æ–‡ä»¶å¿…é¡»åœ¨çº¿å¯ç”¨
4. éƒ¨ç½²å¤æ‚ï¼ˆéœ€è¦å®Œæ•´åç«¯æ ˆï¼‰

### âœ… ç†æƒ³æ¶æ„ï¼šç¼–è¯‘æ—¶è§£è€¦

**ç±»ä¼¼åŸ C# Razor æ¶æ„**ï¼š
```
æ„å»ºæ—¶ï¼š
DSL â†’ é™æ€æ„å»ºå™¨ â†’ ç”Ÿæˆç‹¬ç«‹æ–‡ä»¶
                    â†“
                  dist/
                    â”œâ”€â”€ index.html    (å…¥å£ HTMLï¼Œä¸é¢„æ¸²æŸ“)
                    â”œâ”€â”€ app.js        (æ‰€æœ‰ç»„ä»¶å·²ç¼–è¯‘)
                    â”œâ”€â”€ router.js     (è·¯ç”±é…ç½®)
                    â””â”€â”€ app.css       (æŒ‰ pageId éš”ç¦»æ ·å¼)

è¿è¡Œæ—¶ï¼ˆçº¯ SPAï¼‰:
ç”¨æˆ·è®¿é—® â†’ CDN/Nginx â†’ index.html
                       â†“
                   åŠ è½½ JS/CSS
                       â†“
                   Vue Router æ¥ç®¡
                       â†“
                   åŠ¨æ€æ¸²æŸ“é¡µé¢
```

**ä¼˜åŠ¿**ï¼š
1. âœ… å‰ç«¯å®Œå…¨ç‹¬ç«‹ï¼Œä¸ä¾èµ–åç«¯
2. âœ… éƒ¨ç½²ç®€å•ï¼ˆçº¯é™æ€æ–‡ä»¶ï¼‰
3. âœ… æ€§èƒ½æä½³ï¼ˆCDN + HTTP/2ï¼‰
4. âœ… æˆæœ¬ä½ï¼ˆæ— éœ€æœåŠ¡å™¨è®¡ç®—ï¼‰
5. âœ… çº¯ SPA ä½“éªŒï¼Œè·¯ç”±åˆ‡æ¢æµç•…
6. âœ… CSS æŒ‰ pageId å®¹å™¨éš”ç¦»ï¼Œé¿å…æ ·å¼æ±¡æŸ“

## ä¸¤ç§æ¶æ„å¯¹æ¯”

| ç»´åº¦ | è¿è¡Œæ—¶æ¶æ„ (å½“å‰) | ç¼–è¯‘æ—¶æ¶æ„ (æ–°å¢) |
|-----|------------------|------------------|
| **DSL ä¾èµ–** | è¿è¡Œæ—¶éœ€è¦ | æ„å»ºæ—¶éœ€è¦ï¼Œè¿è¡Œæ—¶ä¸éœ€è¦ |
| **å‰ç«¯ç‹¬ç«‹æ€§** | âŒ ä¾èµ– API Server | âœ… å®Œå…¨ç‹¬ç«‹ |
| **é¦–å±æ€§èƒ½** | SSR ~50ms | é™æ€æ–‡ä»¶ ~5ms |
| **éƒ¨ç½²å¤æ‚åº¦** | é«˜ï¼ˆNode + Redis + Nginxï¼‰ | ä½ï¼ˆçº¯é™æ€æ‰˜ç®¡ï¼‰ |
| **æ‰©å±•æ€§** | éœ€è¦æœåŠ¡å™¨é›†ç¾¤ | CDN è‡ªåŠ¨æ‰©å±• |
| **æˆæœ¬** | æœåŠ¡å™¨ + å¸¦å®½ | ä»… CDN æµé‡ |
| **é€‚ç”¨åœºæ™¯** | é¢‘ç¹æ›´æ–°ã€åŠ¨æ€å†…å®¹ | å†…å®¹ç›¸å¯¹å›ºå®š |
| **SEO** | âœ… æœåŠ¡ç«¯æ¸²æŸ“ | âœ… é¢„æ¸²æŸ“ HTML |
| **æ›´æ–°æ–¹å¼** | çƒ­æ›´æ–° DSL | é‡æ–°æ„å»º + éƒ¨ç½² |

## ä½¿ç”¨æ–¹æ³•

### æ–¹æ¡ˆ A: è¿è¡Œæ—¶æ¶æ„ï¼ˆå½“å‰å®ç°ï¼‰

**é€‚ç”¨åœºæ™¯**ï¼š
- å†…å®¹é¢‘ç¹å˜åŒ–
- éœ€è¦ä¸ªæ€§åŒ–å†…å®¹
- A/B æµ‹è¯•
- ç”¨æˆ·æƒé™æ§åˆ¶

**éƒ¨ç½²æ¶æ„**ï¼š
```bash
# å¯åŠ¨ Redis
docker run -d redis

# å¯åŠ¨ API Server
pnpm dev:api

# å‰ç«¯è®¿é—® API
fetch('/api/render?dslId=xxx&path=/about')
```

### æ–¹æ¡ˆ B: ç¼–è¯‘æ—¶æ¶æ„ï¼ˆæ–°å®ç°ï¼‰

**é€‚ç”¨åœºæ™¯**ï¼š
- å†…å®¹ç›¸å¯¹ç¨³å®š
- å®˜ç½‘ã€æ–‡æ¡£ç«™
- åšå®¢ã€è¥é”€é¡µé¢
- è¿½æ±‚æè‡´æ€§èƒ½

**æ„å»ºæµç¨‹**ï¼š
```bash
# 1. å‡†å¤‡ DSL æ–‡ä»¶
cat > my-site.json << EOF
{
  "dslVersion": "1.0.0",
  "name": "æˆ‘çš„ç«™ç‚¹",
  "pages": [...],
  "routes": [...]
}
EOF

# 2. é™æ€æ„å»º
pnpm build:static -i my-site.json -o dist

# 3. éƒ¨ç½²åˆ°ä»»ä½•é™æ€æ‰˜ç®¡
#    - Vercel
#    - Netlify  
#    - GitHub Pages
#    - é˜¿é‡Œäº‘ OSS
#    - è…¾è®¯äº‘ COS
```

**ç”Ÿæˆçš„æ–‡ä»¶ç»“æ„**ï¼š
```
dist/
â”œâ”€â”€ index.html       # å…¥å£ HTMLï¼ˆä¸é¢„æ¸²æŸ“ï¼Œçº¯ SPAï¼‰
â”œâ”€â”€ app.js          # å®Œæ•´åº”ç”¨ï¼ˆæ‰€æœ‰ç»„ä»¶å·²ç¼–è¯‘ï¼ŒæŒ‰ pageId ç»„ç»‡ï¼‰
â”œâ”€â”€ router.js       # è·¯ç”±é…ç½®ï¼ˆä» DSL ç”Ÿæˆï¼‰
â””â”€â”€ app.css         # æ ·å¼æ–‡ä»¶ï¼ˆæŒ‰ pageId å®¹å™¨éš”ç¦»ï¼‰
```

**å…³é”®ç‰¹æ€§**ï¼š
- ğŸ“„ **å• HTML å…¥å£**ï¼šåªç”Ÿæˆ index.htmlï¼Œä¸ä¸ºæ¯ä¸ªè·¯ç”±ç”Ÿæˆ HTML
- ğŸ¯ **çº¯ SPA æ¨¡å¼**ï¼šå®Œå…¨ç”± Vue Router æ§åˆ¶è·¯ç”±
- ğŸ¨ **æ ·å¼éš”ç¦»**ï¼šæ¯ä¸ªé¡µé¢ç”¨ `.page-{pageId}` å®¹å™¨åŒ…è£¹
- ğŸ“¦ **ç»„ä»¶é¢„ç¼–è¯‘**ï¼šæ‰€æœ‰ç»„ä»¶åœ¨æ„å»ºæ—¶ç¼–è¯‘è¿› app.js

**éƒ¨ç½²ç¤ºä¾‹ï¼ˆNginxï¼‰**ï¼š
```nginx
server {
    listen 80;
    server_name example.com;
    root /var/www/dist;
    index index.html;

    # SPA å›é€€ï¼ˆæ‰€æœ‰è·¯ç”±è¿”å› index.htmlï¼‰
    location / {
        try_files $uri $uri/ /index.html;
    }

    # é™æ€èµ„æºç¼“å­˜
    location ~* \.(js|css|png|jpg|jpeg|gif|ico)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
    
    # Gzip å‹ç¼©
    gzip on;
    gzip_types text/css application/javascript application/json;
}
```

## æ€§èƒ½å¯¹æ¯”

### é¦–å±åŠ è½½æ—¶é—´

**è¿è¡Œæ—¶æ¶æ„ï¼ˆSSRï¼‰**ï¼š
```
è¯·æ±‚ â†’ API Server (50ms) â†’ Redis (3ms) â†’ è¿”å› HTML
æ€»è®¡: ~53ms
ä¼˜åŠ¿: é¦–å±ç›´æ¥æ¸²æŸ“ï¼ŒSEO å‹å¥½
```

**ç¼–è¯‘æ—¶æ¶æ„ï¼ˆçº¯ SPAï¼‰**ï¼š
```
è¯·æ±‚ â†’ CDN/Nginx â†’ index.html (~5ms)
                  â†“
              åŠ è½½ JS/CSS (~100ms)
                  â†“
              Vue Router æ¸²æŸ“ (~20ms)
æ€»è®¡: ~125ms
ä¼˜åŠ¿: åç»­å¯¼èˆªæå¿«ï¼Œæ— åˆ·æ–°
```

### åç»­å¯¼èˆª

ä¸¤è€…ç›¸åŒï¼Œéƒ½æ˜¯ SPA å®¢æˆ·ç«¯è·¯ç”±ï¼š
```
ç‚¹å‡»é“¾æ¥ â†’ Vue Router â†’ åˆ‡æ¢ç»„ä»¶ (~10ms)
```

### èµ„æºåŠ è½½

**è¿è¡Œæ—¶æ¶æ„ï¼ˆSSR + æ‡’åŠ è½½ï¼‰**ï¼š
```
index.html (SSR)           5 KB
+ Vue CDN                  100 KB
+ app.js (åŠ¨æ€åŠ è½½ç»„ä»¶)     æŒ‰éœ€
æ€»è®¡: ~105 KB + æŒ‰éœ€åŠ è½½
```

**ç¼–è¯‘æ—¶æ¶æ„ï¼ˆçº¯ SPAï¼‰**ï¼š
```
index.html (ç©ºå£³)          2 KB
+ Vue CDN                  100 KB
+ app.js (æ‰€æœ‰ç»„ä»¶)        50 KB
+ router.js                5 KB
+ app.css                  10 KB
æ€»è®¡: ~167 KB (ä¸€æ¬¡æ€§åŠ è½½)
```

**æ ·å¼éš”ç¦»ç¤ºä¾‹**ï¼š
```css
/* app.css - æŒ‰ pageId å®¹å™¨éš”ç¦» */
.page-home h1 { color: blue; }
.page-about h1 { color: red; }
.page-contact h1 { color: green; }

/* ä¸ä¼šç›¸äº’æ±¡æŸ“ */
```

## æ··åˆæ–¹æ¡ˆï¼šæœ€ä½³å®è·µ

å®é™…ç”Ÿäº§ä¸­ï¼Œå¯ä»¥æ··åˆä½¿ç”¨ï¼š

### å®˜ç½‘/è¥é”€é¡µ â†’ ç¼–è¯‘æ—¶æ¶æ„
```
www.example.com      â†’ é™æ€æ„å»ºï¼ˆæè‡´æ€§èƒ½ï¼‰
  â”œâ”€â”€ /
  â”œâ”€â”€ /about
  â””â”€â”€ /pricing
```

### åº”ç”¨/åå° â†’ è¿è¡Œæ—¶æ¶æ„
```
app.example.com      â†’ åŠ¨æ€æ¸²æŸ“ï¼ˆçµæ´»æ›´æ–°ï¼‰
  â”œâ”€â”€ /dashboard
  â”œâ”€â”€ /profile
  â””â”€â”€ /settings
```

### éƒ¨ç½²æ¶æ„
```
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚   ç”¨æˆ·è¯·æ±‚   â”‚
                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                 â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
                 â”‚  DNS è§£æ  â”‚
                 â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                       â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚              â”‚              â”‚
   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
   â”‚å®˜ç½‘(CDN)â”‚   â”‚åº”ç”¨(API)â”‚   â”‚æ–‡æ¡£(CDN)â”‚
   â”‚ é™æ€åŒ–   â”‚   â”‚ åŠ¨æ€åŒ–   â”‚   â”‚ é™æ€åŒ–   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## å¯¹æ¯”åŸ C# Razor æ¶æ„

### ç›¸ä¼¼ä¹‹å¤„

**éƒ½æ˜¯ç¼–è¯‘æ—¶è§£è€¦**ï¼š
```
C# Razor:
  DSL â†’ C# ç¼–è¯‘ â†’ JS/CSS â†’ æµè§ˆå™¨åŠ è½½
  
SPARK VIEW (æ–°æ–¹æ¡ˆ):
  DSL â†’ Node ç¼–è¯‘ â†’ HTML/JS/CSS â†’ æµè§ˆå™¨åŠ è½½
```

### æ”¹è¿›ä¹‹å¤„

| ç»´åº¦ | C# Razor | SPARK VIEW é™æ€æ„å»º |
|-----|----------|-------------------|
| **ç¼–è¯‘é€Ÿåº¦** | ä¸­ç­‰ï¼ˆC# ç¼–è¯‘ï¼‰ | å¿«ï¼ˆTS/JS ç¼–è¯‘ï¼‰ |
| **SSR é¢„æ¸²æŸ“** | âŒ éœ€è¦é¢å¤–å·¥å…· | âŒ çº¯ SPAï¼Œä¸é¢„æ¸²æŸ“ |
| **æ ·å¼éš”ç¦»** | CSS Modules | pageId å®¹å™¨éš”ç¦» |
| **ç»„ä»¶ç³»ç»Ÿ** | Razor ç»„ä»¶ | Vue ç»„ä»¶ï¼ˆç”Ÿæ€æ›´ä¸°å¯Œï¼‰ |
| **å¼€å‘ä½“éªŒ** | Visual Studio | VS Code + HMR |
| **è·¨å¹³å°** | âŒ ä¾èµ– .NET | âœ… Node.js å…¨å¹³å° |
| **éƒ¨ç½²** | IIS / Kestrel | ä»»ä½•é™æ€æ‰˜ç®¡ |
| **SEO** | âš ï¸ éœ€è¦é¢„æ¸²æŸ“ | âš ï¸ SPAï¼Œéœ€è¦ SSR æˆ–é¢„æ¸²æŸ“ |

## é€‰æ‹©å»ºè®®

### é€‰æ‹©è¿è¡Œæ—¶æ¶æ„ï¼ˆAPI Serverï¼‰å¦‚æœï¼š
- âœ… éœ€è¦é¢‘ç¹æ›´æ–°å†…å®¹ï¼ˆæ¯å¤©/æ¯å°æ—¶ï¼‰
- âœ… éœ€è¦ä¸ªæ€§åŒ–æ¨è
- âœ… éœ€è¦ A/B æµ‹è¯•
- âœ… éœ€è¦å®æ—¶æ•°æ®
- âœ… æœ‰æœåŠ¡å™¨è¿ç»´èƒ½åŠ›

### é€‰æ‹©ç¼–è¯‘æ—¶æ¶æ„ï¼ˆé™æ€æ„å»ºï¼‰å¦‚æœï¼š
- âœ… å†…å®¹æ›´æ–°ä¸é¢‘ç¹ï¼ˆæ¯å‘¨/æ¯æœˆï¼‰
- âœ… è¿½æ±‚æè‡´æ€§èƒ½
- âœ… é¢„ç®—æœ‰é™
- âœ… ä¸æƒ³ç»´æŠ¤æœåŠ¡å™¨
- âœ… ç®€åŒ–éƒ¨ç½²æµç¨‹

### æ··åˆä½¿ç”¨å¦‚æœï¼š
- âœ… æœ‰å¤šä¸ªå­ç«™ç‚¹
- âœ… æ—¢è¦æ€§èƒ½åˆè¦çµæ´»æ€§
- âœ… å®˜ç½‘ + åº”ç”¨åˆ†ç¦»æ¶æ„

## è¿ç§»è·¯å¾„

ä»è¿è¡Œæ—¶è¿ç§»åˆ°ç¼–è¯‘æ—¶ï¼š

```bash
# 1. å¯¼å‡º DSL
curl http://localhost:3000/api/dsl/my-app > my-app.json

# 2. é™æ€æ„å»º
pnpm build:static -i my-app.json -o dist

# 3. æœ¬åœ°é¢„è§ˆ
pnpm serve dist

# 4. éƒ¨ç½²åˆ°é™æ€æ‰˜ç®¡
vercel deploy dist
# æˆ–
netlify deploy --dir=dist
```

## æ ·å¼éš”ç¦»æœºåˆ¶

### é—®é¢˜ï¼šå¤šé¡µé¢æ ·å¼å†²çª

```html
<!-- æ²¡æœ‰éš”ç¦» -->
<div class="home">
  <h1>æ ‡é¢˜</h1>  <!-- å—åˆ°å…¨å±€ h1 æ ·å¼å½±å“ -->
</div>
```

### è§£å†³ï¼špageId å®¹å™¨éš”ç¦»

**ç”Ÿæˆçš„ç»„ä»¶ä»£ç **ï¼š
```javascript
// home ç»„ä»¶
{
  template: `<div class="page-container page-home">
    <h1>é¦–é¡µæ ‡é¢˜</h1>
  </div>`
}

// about ç»„ä»¶
{
  template: `<div class="page-container page-about">
    <h1>å…³äºæ ‡é¢˜</h1>
  </div>`
}
```

**ç”Ÿæˆçš„ CSS**ï¼š
```css
/* å…¨å±€æ ·å¼ */
.page-container {
  padding: 2rem;
}

/* æŒ‰ pageId éš”ç¦»ï¼ˆå…³é”®ï¼ï¼‰ */
.page-home h1 {
  color: #667eea;
  font-size: 2.5rem;
}

.page-about h1 {
  color: #28a745;
  font-size: 2rem;
}

/* æ ·å¼ä¸ä¼šäº’ç›¸å½±å“ */
```

**ä¼˜åŠ¿**ï¼š
- âœ… ç®€å•ç›´æ¥ï¼Œæ— éœ€é¢å¤–å·¥å…·
- âœ… æ ·å¼ä½œç”¨åŸŸæ˜ç¡®
- âœ… ä¾¿äºè°ƒè¯•ï¼ˆclass åç§°æ¸…æ™°ï¼‰
- âœ… æ”¯æŒå…¨å±€æ ·å¼è¦†ç›–

### å¯¹æ¯”å…¶ä»–æ–¹æ¡ˆ

| æ–¹æ¡ˆ | ä¼˜åŠ¿ | åŠ£åŠ¿ |
|-----|------|------|
| **pageId å®¹å™¨** | ç®€å•ã€ç›´è§‚ã€æ— ä¾èµ– | éœ€è¦å‘½åè§„èŒƒ |
| CSS Modules | è‡ªåŠ¨å“ˆå¸Œï¼Œå®Œå…¨éš”ç¦» | éœ€è¦æ„å»ºå·¥å…·æ”¯æŒ |
| Scoped CSS | Vue åŸç”Ÿæ”¯æŒ | è¿è¡Œæ—¶æ€§èƒ½æŸè€— |
| CSS-in-JS | åŠ¨æ€æ ·å¼çµæ´» | åŒ…ä½“ç§¯å¤§ï¼Œæ€§èƒ½å·® |

## è¿ç§»è·¯å¾„

ä»è¿è¡Œæ—¶è¿ç§»åˆ°ç¼–è¯‘æ—¶ï¼š

```bash
# 1. å¯¼å‡º DSL
curl http://localhost:3000/api/dsl/my-app > my-app.json

# 2. é™æ€æ„å»º
pnpm build:static -i my-app.json -o dist

# 3. æœ¬åœ°é¢„è§ˆ
pnpm serve dist

# 4. éƒ¨ç½²åˆ°é™æ€æ‰˜ç®¡
vercel deploy dist
# æˆ–
netlify deploy --dir=dist
```

## æ€»ç»“

**åŸæ¥çš„è§‚å¯Ÿæ˜¯æ­£ç¡®çš„**ï¼šç†æƒ³æƒ…å†µä¸‹ï¼Œ**å‰ç«¯åº”ç”¨ä¸ DSL åº”è¯¥è§£è€¦**ã€‚

- **è¿è¡Œæ—¶æ¶æ„**ï¼šé€‚åˆåŠ¨æ€å†…å®¹ï¼Œä½†å‰ç«¯ä»ä¾èµ– DSL
- **ç¼–è¯‘æ—¶æ¶æ„**ï¼šå‰ç«¯å®Œå…¨ç‹¬ç«‹ï¼Œç±»ä¼¼åŸ C# Razor æ–¹æ¡ˆ
- **æœ€ä½³å®è·µ**ï¼šæ ¹æ®åœºæ™¯æ··åˆä½¿ç”¨

æ–°å¢çš„é™æ€æ„å»ºå™¨è®©ä½ å¯ä»¥åƒåŸæ¥ä¸€æ ·ï¼Œå°† DSL å®Œå…¨ç¼–è¯‘æˆç‹¬ç«‹çš„é™æ€æ–‡ä»¶ï¼Œå‰ç«¯è¿è¡Œæ—¶ä¸å†éœ€è¦ DSL æˆ–ä»»ä½•åç«¯æœåŠ¡ã€‚
